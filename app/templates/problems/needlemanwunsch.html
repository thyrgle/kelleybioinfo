<!-- TODO: Fix styling -->
{% extends 'problems/problems.html' %}
{% block problem %}
  <form method="post" id="problem-form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    <table class="matrix">
      <tbody>
        <tr>
          <!-- The '  ' is used for correct table alignment. -->
          {% for base in ( '  ' + sequences[0]) %}
	    <td class="cell amino"> {{ base }} </td>
	  {% endfor %}
        </tr>
        {% for row in matrix %}
	  {% set outer_loop = loop.index0 %}
          <tr>
	    <td class="cell amino">
	      {{ (' ' + sequences[1])[loop.index0] }} </td>
	    </td>
            {% for entry in row %}
	      <td class="cell">
	        <table width="100%" height="100%">
                  <tbody>
	            <tr>
		      {% if entry.top_left == None %}
		        <td class="subcell"> &nbsp; </td> 
		      {% else %}
                        <td class="subcell"> {{ entry.top_left }} </td>
		      {% endif %}
		      {% if entry.top_right == None %}
			<td class="subcell"> &nbsp; </td>
		      {% else %}
                        <td class="subcell"> {{ entry.top_right }} </td>
		      {% endif %}
                    </tr>
	            <tr>
		      {% if entry.bottom_left == None %}
		        <td class="subcell"> &nbsp; </td>
		      {% else %}
                        <td class="subcell"> {{ entry.bottom_left }} </td>
		      {% endif %}
	              <td class="subcell">
                        <input name="hidden-{{ outer_loop }}-{{ loop.index0 }}" 
	                       value="{{ entry.main_entry }}"
		               type="hidden" />
                        <input name="{{ outer_loop }}-{{ loop.index0 }}" type="hidden"/>
                        {{ entry.main_entry }} 
                      </td>
		    </tr>  
                  </tbody>
                </table>
	      </td>
	    {% endfor %}
	  </tr>
        {% endfor %}
      </tbody>
    </table>
  </form>
  <script>
    $( ".cell" ).click(function() {
      $( this ).toggleClass( "selected-cell" );
    });
    $( ".selected-cell" ).click(function() {
      $( this ).toggleClass( "cell" );
    });
  </script>
{% endblock %}
